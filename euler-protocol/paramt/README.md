# パラメーター

### 借入ファクター

誰かが資産 XYZ に対して貸出市場をアクティブにすると、それはデフォルトでIsolated資産となり、その借入係数は 0.28 となります。&#x20;

つまり、USDC を貸し出し（担保係数 0.90）、XYZ をデフォルト・ボロー・ファクター（ボロー・ファクター 0.28）で借りると、実効ファクターは約 0.25（0.90×0.28 ）になります。&#x20;

従って、デフォルト資産を借り入れる際には、最低でも4倍の過剰担保を設定する必要があります。担保倍率が低い資産に対して借入を行う場合、倍率はさらに保守的になります。 保守的な過剰担保は、不良債権を防ぐためのものである。&#x20;

例えば、借りた資産XYZが急激に高騰し、ユーザーの健康状態が1以下になり、清算の対象となったとする。清算人がそのユーザーを清算するインセンティブを得るには、違反者の貸与資産に相当する魅力的な清算ボーナスを受け取る必要があります。もし、ボーナスに見合うだけの貸与資産がなければ、清算人は清算をしないことを選択することになる。これが不良債権の発生につながる。&#x20;

あるいは、誰かがXYZの価格を低く操作して、通常より多くのXYZを借りることができるようにすることもできる。最終的に、価格は裁定され正常化し、健康状態は1以下に低下します。ポジションは大きく過剰担保されているので、融資を裏付ける十分な担保がまだあり、したがって清算人は債務を返済するインセンティブがあります。 担保と借入要因の詳細については、当社のリスクに関する資料をご覧ください。[https://docs.euler.finance/risk-framework/collateral-and-borrow-factors](https://docs.euler.finance/risk-framework/collateral-and-borrow-factors)

### リザーブファクター

デフォルトのリザーブファクターは23%に設定されている。 つまり、借り手が XYZ の資産に支払った利息 1 ドルに対して、23c が XYZ の準備金プールに支払われ、残りの 77c は XYZ の貸し手に支払われることになる。これらの準備金は、後にプールで発生した不良債権の返済に充当される可能性がある。 リザーブファクターが高ければ、理論的には、貸出プールを支えるためにより多額のリザーブを蓄積することができますが、ある時点では、受け取る利息が少なすぎるため、貸し手の意欲を減退させることになります。 また、リザーブファクターが低すぎると、準備金の積み上げの機会が失われ、貸し手との信頼関係が損なわれます。 リザーブファクターが23%というのは、リザーブの増強と貸し出しの奨励のバランスが絶妙で、特にEulerプロトコルの最初の数年間は、寛大なEULの分配スキームが適用されると考えています。

### 金利モデル

最終的には、利用率を最適化するリアクティブ金利モデルに移行する予定ですが、まずは標準的なKinkモデルでスタートします。デフォルトのKinkモデルは「スモールキャップ」モデルで、そのパラメータは次のとおりです。

1. Base IR: **0%** (APY when utilisation is 0%)
2. Kink IR: **10%** (APY when utilisation is exactly Kink%)
3. Max IR: **300%** (APY when utilisation is 100%)
4. Kink%: **50%** (Percent utilisation where kink occurs)

デフォルト資産とその活用が極めて不安定であることを考えると、貸し手が常に撤退リスクにさらされないようにすることが重要である。

そのため、稼働率がKink%を超えて急上昇した場合、高い最大IRは借入を維持するためのコストがかかりすぎるため、撤退リスクを低下させる。

### 価格設定のパラメーター

#### Uniswap3 Pool Fee-Level

デフォルトのuniswap3プールの料金レベルは、0.3％、0.05％、1％のうち最初の既存のものです

資産価格を取得するために、EulerはXYZ/WETHのペアでUniswap3の時間加重平均価格（TWAP）を使用します（XYZは当該資産、WETHは参照資産です）。Uniswap3は同じペアで手数料レベルの異なる複数のプールをサポートしているため、実際にどのプールに問い合わせるかは、資産ごとに設定する必要があります。

理論的には、プールは裁定取引によって同程度の価格に収束するはずですが、必ずしもそうではありません。例えば、プールの流動性が不十分で、裁定取引ボットにとって収益性が低い場合などです。さらに、流動性の量は価格操作のコストに影響を与える。

資産層を昇格させるためには、設定されたプール料金の見直しを行う必要があります。場合によっては、価格操作のコストを上げるために、「フルレンジの流動性」を余分に追加しなければならない。

#### TWAP Length

TWAPの長さは、デフォルトで30分に設定されています。

EulerはUniswap v3 TWAPsをEuler上のすべての資産および負債の価格設定オラクルとして使用しています。

[ホワイトペーパー](../../gai-yao/howaitopp.md)で説明したように、TWAPは本質的に、与えられたUniswap v3プールで発生した取引の移動平均です。TWAPを使用する意図は、TWAPウィンドウが長くなればなるほど、価格操作に法外なコストがかかるようになるということです。

しかし、TWAPが長すぎると、Uniswapでの最終取引価格とTWAPの間に大きなラグが生じ、不良債権化するリスクがある。

例えば、あるユーザーが担保としてETHを預け、XYZトークンを借りたとします。そのユーザーのXYZの負債が70ドル分に膨れ上がり、清算の対象になったとします。清算人はそのXYZの負債の一部を引き受け、返済しなければならないでしょう。

しかし、負債がTWAPベースで価格決定されている一方で、清算人がその負債を返済するためには、市場でXYZを購入する必要があることを思い出してください。彼の負債の市場価格が120ドルであれば、清算人は、違反者のTWAP価格の資産に清算ボーナスを加えたより少ない金額を受け取るために、市場で高く買っていることになります。

したがって、TWAPの遅れによってTWAP-市場価格スプレッドが著しく大きくなった場合、清算が不活発になる可能性があります。

あるいは、TWAPが短すぎるということは、資産価格を操作するのが非常に安易になるということです。例えば、担保となる資産の価格を人為的につり上げ、不釣り合いな量のXYZトークンを借りて、それを持ち逃げすることができるのです。

マイケル・ベントレーが書いたTWAP価格設定の攻撃コストに関する論文をご覧ください。 [https://github.com/euler-xyz/uni-v3-twap-manipulation/blob/master/cost-of-attack.pdf](https://github.com/euler-xyz/uni-v3-twap-manipulation/blob/master/cost-of-attack.pdf)

さらに、Seraphimによる、オラクル操作に関連する可能性のある攻撃と、Eulerがどのようにそれを防いでいるかについてのブログ記事もご覧ください。 [https://blog.euler.finance/risks-in-crypto-a-lending-protocol-perspective-376e19c1d01a](https://blog.euler.finance/risks-in-crypto-a-lending-protocol-perspective-376e19c1d01a)

#### Uniswap Observation Cardinality

uniswap3 cardinalityの最小値は10です。マーケットが有効になると、価格設定に使用されるuniswap3プールのカーディナリティは、現在この値以下であれば、この値まで増加されます。

TWAPを維持するために、各uniswap3プールは、過去の時点における累積価格の履歴記録を保持する必要があります。各レコードは観測と呼ばれ、その数は観測のカーディナリティと呼ばれます。残念ながら、これらのレコードのためのストレージを予約すると、ガスがかかります。 カーディナリティが大きければ大きいほど、TWAPウィンドウは長くなります。ブロックごとにスワップが実行される場合、可能な最長のTWAPは、カーディナリティに直近のNブロックの平均ブロックタイムを掛けたものになります。 Eulerでは、設定された長さのTWAPを取得することができない場合、代わりに最も古い利用可能な価格が使用される。これは、プロトコルが常に対話可能であることを意味し、清算を防ぐことを目的としたある種の攻撃を防ぐことができる。しかし、それはまた、カーディナリティがプールの重要なセキュリティパラメータであることを意味する。 この低い最小値によって、マーケットを有効化することがあまり高価でないことが保証される。しかし、より長いTWAPウィンドウを確保するためにはより大きなカーディナリティが必要であるため、資産をより高い階層に昇格させるためには、より大きな値のカーディナリティ、通常は144またはそれ以上が必要になります。

### 清算パラメーター

#### Target Health Factor

デフォルトの目標健康状態は1.25です。

リスク調整後負債がリスク調整後担保を上回り、違反状態にある場合、そのユーザーの健康状態は1を下回る。しかし、清算が入った場合、違反者から健康状態を1.25に移行させるだけの負債と資産を取り上げることができる。

この機能は、ホワイトペーパーにあるように[ソフト・清算](../../gai-yao/howaitopp.md#sofuto)と呼ばれ、負債の50％が清算される他のプロトコルに比べて、はるかに優れた借入経験を生み出すものです。

とはいえ、目標とする健康状態を1.00に設定していたら、清算が不活発になるリスクに直面したことでしょう。つまり、返済される債務の大きさと、その結果として得られる報酬が小さすぎて、清算人のインセンティブが働かない可能性があります。 同様に、不安定な市場では、1.00に戻されることは、ユーザーがすぐに何度も1.00以下に落ち込むことを意味し、それは清算人のガス代が高く、報酬が減り続けることを意味します。 私たちは、1.25は良い借り入れ体験と良い清算インセンティブの間の良いトレードオフであると考えています。

#### Maximum Liquidation Discount

デフォルトの最大清算割引は20%に設定されています。

ユーザーが清算の対象となると、負債（dToken）と資産（eToken）の一部が清算人に譲渡され、健康状態が1.25に移行する。 しかし、清算人にこの作業をさせるインセンティブとして、清算人はeTokenを割引価格で受け取る。割引を別の言葉で言うと、資産価値に上乗せしてボーナスを受け取るということです。 Liquidation Surchargeとブースターを除いた簡単な例を考えてみましょう。

あるユーザーの健康状態が0.90であるとします。この場合、清算時の割引率は10%（1 - 0.90）です。したがって、100ドル相当のdTokenを引き受けた場合、清算人は110ドル相当のeTokenを受け取ることになります。 割引が低すぎると、清算人は清算を行うことをためらうかもしれません。あるいは、割引が高すぎると、借り手は自分の資産を清算人に渡しすぎてしまうことになります。これは、清算のたびにユーザーの資産額が減少するため、健康状態が1.25に戻らなくなるリスクも生じます。 したがって、借り手の経験を改善するために、清算割引の上限を20%に設定しています。

#### Liquidation Surcharge

清算割増金の初期値は2％に設定されています。

清算人が誰かの借金を引き受けるときは、必ず最初に違反者から取った額より2％多く返済する必要がある。それを補うために、違反者は清算人に貸した資産の2％を追加で支払う。

これは、次の2つを目的としています。

1. 割増金はリザーブプールに蓄積されるため、清算のたびにプールが健全化される。ボラティリティの高い資産ほど、清算が頻繁に行われ、プールが大きくなる。
2. 悪意のある自己清算を阻止する。割増金があるため、自己清算はすべて純損失になる。

#### Liquidation Booster Ceiling and Slope

デフォルトのLiquidation Boosterは、シーリングが2.5％、スロープが2倍に設定されています。 清算人にインセンティブを与えるために、彼らはEulerを通して貸すべき同業者よりも競争力があるかもしれません。 例えば、ユーザーの健康状態が0.90で、リスク調整後の負債額が1,000ドルの場合、暗黙の清算割引は10%（1 - 健康状態）である。しかし、スリッページとガス代により、清算は11%の割引でしか利益を得られない。 同時に、1,000ドルのリスク調整済み担保を供給した清算人は、2.5%の上限で他の市場より2倍の競争力を持つことができます。彼が10%の割引でユーザーの債務を引き受けるべきであり、実際にはより寛大な12.5%の割引（2.5%ブースター+10%清算割引）を受けることになる。 なぜ、このような数字になったのか。清算割引の総額は次のように計算される。

$$
TotalLiqDiscount = (1-HealthFactor)*LiqBooster + LiqSurcharge
$$

$$
LiqBooster = 1 + 2 * \frac{min(RADV, RASAL)}{RADV}
$$

RASAL = 清算人によるリスク調整後の供給資産

RADV = 違反者によるリスク調整後の負債

LiqSurchargeはこのページの上の方で説明されていますが、この例では簡単のために0と仮定しています。

2倍はliquidation booster slopeです。

Liquidation Boosterは、2.5%の上限が設定されています。

上限を2.5％とした理由は、清算割引の上限を20％としたのと同じで、清算時に借り手が過剰な支払いをするのを防ぐためである。一方、2倍の傾斜は、清算人が資産を預けるほど徐々に競争力を高めるが、独占を生み出さないよう、法外な競争力を高めることを意図している。
